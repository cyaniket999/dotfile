#################################
#             General           #
#################################
backend = "glx";
vsync = true;
use-damage = false;
log-level = "warn";

# Modern stability tweaks (Deprecated flags removed)
detect-client-opacity = true;
detect-rounded-corners = true;
unredir-if-possible = false;

#################################
#             Corners           #
#################################
corner-radius = 14;

rounded-corners-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'"
];

#################################
#             Shadows           #
#################################
shadow = true;
shadow-radius = 40;
shadow-opacity = 0.35;
shadow-offset-x = -30;
shadow-offset-y = -25;
shadow-color = "#000000";

shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Polybar'",
  "class_g = 'Plank'",
  "_GTK_FRAME_EXTENTS"
];

#################################
#             Blur              #
#################################
blur: {
  method = "dual_kawase";
  strength = 7;
  background = true;
  background-frame = false;
  background-fixed = false;
},

blur-background-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "class_g = 'slop'",
  "_GTK_FRAME_EXTENTS"
];

#################################
#        Transparency           #
#################################
active-opacity = 0.98;
inactive-opacity = 0.90;

opacity-rule = [
  "100:class_g = 'firefox'",
  "100:class_g = 'mpv'",
  "100:class_g = 'Alacritty' && focused",
  "90:class_g = 'Alacritty' && !focused"
];

#################################
#           Fading              #
#################################
fading = true;
fade-in-step = 0.03;
fade-out-step = 0.03;
fade-delta = 5;

fade-exclude = [ "class_g = 'Plank'" ];


#################################
#      Animations   #
#################################
# Valid presets for v13: "appear", "disappear", "geometry-change"
# To "zoom", we use "appear" + a low starting scale.

beziers = (
  {
    name = "macosCurve";
    data = [0.17, 0.67, 0.83, 0.67];
  },
)

animations = (
  {
    triggers = ["open", "show"];
    preset = "appear";       # Use 'appear' for opening
    scale = 0.85;            # Starts at 85% size (creates the 'zoom' effect)
    duration = 0.4;
    curve = "macosCurve";
  },
  {
    triggers = ["close", "hide"];
    preset = "disappear";    # Use 'disappear' for closing
    scale = 0.85;            # Shrinks to 85% while fading out
    duration = 0.4;
    curve = "macosCurve";
  },
  {
    triggers = ["geometry"];
    preset = "geometry-change";
    duration = 0.3;
    curve = "macosCurve";
  }
)
